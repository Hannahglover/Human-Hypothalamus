print(SuppEmerg)
dev.off()
View(SelectData_Condensed)
colnames(SelectData_Condensed)
######################################
Fig3_4_ComboInhibDatawZeros = Fig3_4_ComboInhibData
ExclLR_All = subset(Fig3_4_ComboInhibDatawZeros,  Fig3_4_ComboInhibDatawZeros$Combo %notin% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
OnlyLR_All = subset(Fig3_4_ComboInhibDatawZeros,  Fig3_4_ComboInhibDatawZeros$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
OnlyLR_All[c("CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")][is.na(OnlyLR_All[c("CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")])] <- 0
Fig3_4_ComboInhibDatawZeros = rbind(OnlyLR_All, ExclLR_All)
#
#
SuppControlEmergFigs = list()
Data_To_Plot = c("Prolif_2", "Prolif_4", "Prolif_6", "Apoptosis_2", "Apoptosis_4", "Apoptosis_6", "CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")
for(e in Data_To_Plot){
if(grepl("Apoptosis", e, fixed = TRUE) == T){
PlotTitle = "Apoptosis"
Control_Ylab = "% Annexin V+"
}
if(grepl("Prolif", e, fixed = TRUE)){
PlotTitle = "Proliferation"
Control_Ylab = "% BrdU +"
}
if(grepl("CellNoNorm", e, fixed = TRUE)){
PlotTitle = "Cell number"
Control_Ylab = "Fold change"
}
if(grepl("Morphology", e, fixed = TRUE)){
PlotTitle = "Morphology"
Control_Ylab = "Morphology score"
}
if(grepl("2", e, fixed = TRUE)){
DayFactor = " - Day 2"
}
if(grepl("4", e, fixed = TRUE)){
DayFactor = " - Day 4"
}
if(grepl("6", e, fixed = TRUE)){
DayFactor = " - Day 6"
}
SelectData = Fig3_4_ComboInhibDatawZeros[, c("Combo", e)]
colnames(SelectData) = c("Combo", "Value")
SelectData = na.omit(SelectData)
if(DayFactor %in% c(" - Day 4", " - Day 6")){
SelectData$Value = ifelse(SelectData$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData$Value)
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
SelectData_Condensed$n = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData_Condensed$n)
}else{
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
}
#if(DayFactor == " - Day 2"){
SelectData_Condensed$LRColour = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), "Blue", "Neutral")
###
SelectData_Condensed$ComboWn = paste(SelectData_Condensed$Combo, " (n = ", SelectData_Condensed$n, ")", sep="")
SelectData_merge = merge(SelectData_Condensed, SelectData, by = "Combo")
SelectData_Samples = subset(SelectData, SelectData$Combo %in% SelectData_Condensed$Combo)
PullNames = SelectData_Condensed[, c("Combo", "ComboWn")]
SelectData_Samples = merge(SelectData_Samples, PullNames, by = "Combo")
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = SelectData_Condensed$ComboWn)
ANOVARes = DunnettTest(x=SelectData_Samples$Value, g=SelectData_Samples$Combo, control = "DMSO")
ANOVAResOuts = as.data.frame(ANOVARes[[1]])
row.names(ANOVAResOuts) = gsub("-DMSO", "", row.names(ANOVAResOuts))
ANOVAResOuts$Combo = row.names(ANOVAResOuts)
SelectData_Condensed = merge(SelectData_Condensed, ANOVAResOuts, by = "Combo", all=T)
SelectData_Condensed$Sig = ifelse(SelectData_Condensed$pval < 0.05, "*", NA)
SelectData_Condensed$Sig =ifelse(SelectData_Condensed$LRColour == "Neutral" & DayFactor %in% c(" - Day 4", " - Day 6"), SelectData_Condensed$Sig, NA)
SelectData_Condensed$Combo = factor(SelectData_Condensed$Combo, levels = c("DMSO", "U", "S", "L", "R", "P", "U+S", "U+L", "U+R", "U+P", "S+L", "S+R", "S+P", "L+R", "L+P", "R+P", "U+S+L", "U+S+R","U+L+R", "U+R+P", "U+S+P","U+L+P","S+L+R", "S+L+P", "S+R+P", "L+R+P", "U+S+R+P", "U+S+L+R", "U+S+L+P", "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$Combo),]
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = unique(SelectData_Condensed$ComboWn))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$ComboWn),]
if(e %in% c("Prolif_2", "Prolif_4", "Prolif_6")){Axis = c(0,100)}else{Axis = c(0, max(SelectData_Samples$Value)*1.2)}
SuppControlEmergFigs[[e]] = ggplot(SelectData_Condensed, aes(x=ComboWn, y=Mean,fill = LRColour)) + geom_bar(stat = "identity", color = "#000000") + scale_fill_manual(values = c("Neutral" =  ColourNeutral, "Blue" = ColourTwoWay))  +theme_classic() + geom_hline(yintercept=0) + ylab(Control_Ylab) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2) + theme(legend.position="none", plot.title = element_text(size = 15, face = "bold"), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(paste(PlotTitle, DayFactor, sep = "")) + geom_point(data=SelectData_merge, aes(x = ComboWn, y =Value), color = "#000000", fill = "#000000", size = 0.5)+ geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*6))), position = position_dodge(width = 0.9), size = 1, show.legend = F)+ scale_shape_manual(values=c(8))  + scale_y_continuous(limits = Axis, expand = c(0,0)) + geom_point(data=SelectData_Samples, aes(x = ComboWn, y =Value, fill = "#000000"), size=0.5)
}
SuppEmerg = ggarrange(plotlist = SuppControlEmergFigs, ncol = 1, nrow=3)
pdf(paste(FilePath, "FigureS3S4S5_EmergentPropertiesRaw.pdf", sep=""), width = 12, height = 3*2.8)
print(SuppEmerg)
dev.off()
######################################
Fig3_4_ComboInhibDatawZeros = Fig3_4_ComboInhibData
ExclLR_All = subset(Fig3_4_ComboInhibDatawZeros,  Fig3_4_ComboInhibDatawZeros$Combo %notin% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
OnlyLR_All = subset(Fig3_4_ComboInhibDatawZeros,  Fig3_4_ComboInhibDatawZeros$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
OnlyLR_All[c("CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")][is.na(OnlyLR_All[c("CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")])] <- 0
Fig3_4_ComboInhibDatawZeros = rbind(OnlyLR_All, ExclLR_All)
#
#
SuppControlEmergFigs = list()
Data_To_Plot = c("Prolif_2", "Prolif_4", "Prolif_6", "Apoptosis_2", "Apoptosis_4", "Apoptosis_6", "CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")
for(e in Data_To_Plot){
if(grepl("Apoptosis", e, fixed = TRUE) == T){
PlotTitle = "Apoptosis"
Control_Ylab = "% Annexin V+"
}
if(grepl("Prolif", e, fixed = TRUE)){
PlotTitle = "Proliferation"
Control_Ylab = "% BrdU +"
}
if(grepl("CellNoNorm", e, fixed = TRUE)){
PlotTitle = "Cell number"
Control_Ylab = "Fold change"
}
if(grepl("Morphology", e, fixed = TRUE)){
PlotTitle = "Morphology"
Control_Ylab = "Morphology score"
}
if(grepl("2", e, fixed = TRUE)){
DayFactor = " - Day 2"
}
if(grepl("4", e, fixed = TRUE)){
DayFactor = " - Day 4"
}
if(grepl("6", e, fixed = TRUE)){
DayFactor = " - Day 6"
}
SelectData = Fig3_4_ComboInhibDatawZeros[, c("Combo", e)]
colnames(SelectData) = c("Combo", "Value")
SelectData = na.omit(SelectData)
if(DayFactor %in% c(" - Day 4", " - Day 6")){
SelectData$Value = ifelse(SelectData$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData$Value)
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
SelectData_Condensed$n = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData_Condensed$n)
}else{
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
}
#if(DayFactor == " - Day 2"){
SelectData_Condensed$LRColour = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), "Blue", "Neutral")
###
SelectData_Condensed$ComboWn = paste(SelectData_Condensed$Combo, " (n = ", SelectData_Condensed$n, ")", sep="")
SelectData_merge = merge(SelectData_Condensed, SelectData, by = "Combo")
SelectData_Samples = subset(SelectData, SelectData$Combo %in% SelectData_Condensed$Combo)
PullNames = SelectData_Condensed[, c("Combo", "ComboWn")]
SelectData_Samples = merge(SelectData_Samples, PullNames, by = "Combo")
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = SelectData_Condensed$ComboWn)
ANOVARes = DunnettTest(x=SelectData_Samples$Value, g=SelectData_Samples$Combo, control = "DMSO")
ANOVAResOuts = as.data.frame(ANOVARes[[1]])
row.names(ANOVAResOuts) = gsub("-DMSO", "", row.names(ANOVAResOuts))
ANOVAResOuts$Combo = row.names(ANOVAResOuts)
SelectData_Condensed = merge(SelectData_Condensed, ANOVAResOuts, by = "Combo", all=T)
SelectData_Condensed$Sig = ifelse(SelectData_Condensed$pval < 0.05, "*", NA)
if(DayFactor %in% c(" - Day 4", " - Day 6")){
SelectData_Condensed$Sig =ifelse(SelectData_Condensed$LRColour == "Neutral", SelectData_Condensed$Sig, NA)
}
SelectData_Condensed$Combo = factor(SelectData_Condensed$Combo, levels = c("DMSO", "U", "S", "L", "R", "P", "U+S", "U+L", "U+R", "U+P", "S+L", "S+R", "S+P", "L+R", "L+P", "R+P", "U+S+L", "U+S+R","U+L+R", "U+R+P", "U+S+P","U+L+P","S+L+R", "S+L+P", "S+R+P", "L+R+P", "U+S+R+P", "U+S+L+R", "U+S+L+P", "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$Combo),]
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = unique(SelectData_Condensed$ComboWn))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$ComboWn),]
if(e %in% c("Prolif_2", "Prolif_4", "Prolif_6")){Axis = c(0,100)}else{Axis = c(0, max(SelectData_Samples$Value)*1.2)}
SuppControlEmergFigs[[e]] = ggplot(SelectData_Condensed, aes(x=ComboWn, y=Mean,fill = LRColour)) + geom_bar(stat = "identity", color = "#000000") + scale_fill_manual(values = c("Neutral" =  ColourNeutral, "Blue" = ColourTwoWay))  +theme_classic() + geom_hline(yintercept=0) + ylab(Control_Ylab) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2) + theme(legend.position="none", plot.title = element_text(size = 15, face = "bold"), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(paste(PlotTitle, DayFactor, sep = "")) + geom_point(data=SelectData_merge, aes(x = ComboWn, y =Value), color = "#000000", fill = "#000000", size = 0.5)+ geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*6))), position = position_dodge(width = 0.9), size = 1, show.legend = F)+ scale_shape_manual(values=c(8))  + scale_y_continuous(limits = Axis, expand = c(0,0)) + geom_point(data=SelectData_Samples, aes(x = ComboWn, y =Value, fill = "#000000"), size=0.5)
}
SuppEmerg = ggarrange(plotlist = SuppControlEmergFigs, ncol = 1, nrow=3)
pdf(paste(FilePath, "FigureS3S4S5_EmergentPropertiesRaw.pdf", sep=""), width = 12, height = 3*2.8)
print(SuppEmerg)
dev.off()
DayFactor
DayFactor %in% c(" - Day 4", " - Day 6")
SelectData$Value = ifelse(SelectData$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData$Value)
View(SelectData)
151/3
CHECK = subset(SelectData, SelectData$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P") )
CHECK = subset(c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), ! c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P") %in% SelectData$Combo)
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
View(SelectData_Condensed)
SelectData_Condensed$n = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData_Condensed$n)
View(SelectData_Condensed)
#if(DayFactor == " - Day 2"){
SelectData_Condensed$LRColour = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), "Blue", "Neutral")
###
SelectData_Condensed$ComboWn = paste(SelectData_Condensed$Combo, " (n = ", SelectData_Condensed$n, ")", sep="")
SelectData_merge = merge(SelectData_Condensed, SelectData, by = "Combo")
PullNames = SelectData_Condensed[, c("Combo", "ComboWn")]
SelectData_Samples = merge(SelectData_Samples, PullNames, by = "Combo")
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = SelectData_Condensed$ComboWn)
ANOVARes = DunnettTest(x=SelectData_Samples$Value, g=SelectData_Samples$Combo, control = "DMSO")
ANOVAResOuts = as.data.frame(ANOVARes[[1]])
row.names(ANOVAResOuts) = gsub("-DMSO", "", row.names(ANOVAResOuts))
ANOVAResOuts$Combo = row.names(ANOVAResOuts)
SelectData_Condensed = merge(SelectData_Condensed, ANOVAResOuts, by = "Combo", all=T)
SelectData_Condensed$Sig = ifelse(SelectData_Condensed$pval < 0.05, "*", NA)
if(DayFactor %in% c(" - Day 4", " - Day 6")){
SelectData_Condensed$Sig =ifelse(SelectData_Condensed$LRColour == "Neutral", SelectData_Condensed$Sig, NA)
}
View(SelectData_Condensed)
DayFactor
dim(SelectData_Condensed)
SelectData_Condensed$Combo = factor(SelectData_Condensed$Combo, levels = c("DMSO", "U", "S", "L", "R", "P", "U+S", "U+L", "U+R", "U+P", "S+L", "S+R", "S+P", "L+R", "L+P", "R+P", "U+S+L", "U+S+R","U+L+R", "U+R+P", "U+S+P","U+L+P","S+L+R", "S+L+P", "S+R+P", "L+R+P", "U+S+R+P", "U+S+L+R", "U+S+L+P", "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$Combo),]
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = unique(SelectData_Condensed$ComboWn))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$ComboWn),]
if(e %in% c("Prolif_2", "Prolif_4", "Prolif_6")){Axis = c(0,100)}else{Axis = c(0, max(SelectData_Samples$Value)*1.2)}
ggplot(SelectData_Condensed, aes(x=ComboWn, y=Mean,fill = LRColour)) + geom_bar(stat = "identity", color = "#000000") + scale_fill_manual(values = c("Neutral" =  ColourNeutral, "Blue" = ColourTwoWay))  +theme_classic() + geom_hline(yintercept=0) + ylab(Control_Ylab) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2) + theme(legend.position="none", plot.title = element_text(size = 15, face = "bold"), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(paste(PlotTitle, DayFactor, sep = "")) + geom_point(data=SelectData_merge, aes(x = ComboWn, y =Value), color = "#000000", fill = "#000000", size = 0.5)+ geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*6))), position = position_dodge(width = 0.9), size = 1, show.legend = F)+ scale_shape_manual(values=c(8))  + scale_y_continuous(limits = Axis, expand = c(0,0)) + geom_point(data=SelectData_Samples, aes(x = ComboWn, y =Value, fill = "#000000"), size=0.5)
rlang::last_trace()
ggplot(SelectData_Condensed, aes(x=ComboWn, y=Mean,fill = LRColour)) + geom_bar(stat = "identity", color = "#000000") + scale_fill_manual(values = c("Neutral" =  ColourNeutral, "Blue" = ColourTwoWay))  +theme_classic() + geom_hline(yintercept=0) + ylab(Control_Ylab) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2) + theme(legend.position="none", plot.title = element_text(size = 15, face = "bold"), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(paste(PlotTitle, DayFactor, sep = "")) + geom_point(data=SelectData_merge, aes(x = ComboWn, y =Value), color = "#000000", fill = "#000000", size = 0.5)+ geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*6))), position = position_dodge(width = 0.9), size = 1, show.legend = F)+ scale_shape_manual(values=c(8))  + scale_y_continuous(limits = Axis, expand = c(0,0)) + geom_point(data=SelectData_Samples, aes(x = ComboWn, y =Value, fill = "#000000"), size=0.5)
if(DayFactor %in% c(" - Day 4", " - Day 6")){
SelectData$Value = ifelse(SelectData$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData$Value)
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
SelectData_Condensed$n = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData_Condensed$n)
}else{
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
}
#if(DayFactor == " - Day 2"){
SelectData_Condensed$LRColour = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), "Blue", "Neutral")
###
SelectData_Condensed$ComboWn = paste(SelectData_Condensed$Combo, " (n = ", SelectData_Condensed$n, ")", sep="")
SelectData_merge = merge(SelectData_Condensed, SelectData, by = "Combo")
SelectData_Samples = subset(SelectData, SelectData$Combo %in% SelectData_Condensed$Combo)
PullNames = SelectData_Condensed[, c("Combo", "ComboWn")]
SelectData_Samples = merge(SelectData_Samples, PullNames, by = "Combo")
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = SelectData_Condensed$ComboWn)
ANOVARes = DunnettTest(x=SelectData_Samples$Value, g=SelectData_Samples$Combo, control = "DMSO")
ANOVAResOuts = as.data.frame(ANOVARes[[1]])
row.names(ANOVAResOuts) = gsub("-DMSO", "", row.names(ANOVAResOuts))
ANOVAResOuts$Combo = row.names(ANOVAResOuts)
SelectData_Condensed = merge(SelectData_Condensed, ANOVAResOuts, by = "Combo", all=T)
SelectData_Condensed$Sig = ifelse(SelectData_Condensed$pval < 0.05, "*", NA)
if(DayFactor %in% c(" - Day 4", " - Day 6")){
SelectData_Condensed$Sig =ifelse(SelectData_Condensed$LRColour == "Neutral", SelectData_Condensed$Sig, NA)
}
SelectData_Condensed$Combo = factor(SelectData_Condensed$Combo, levels = c("DMSO", "U", "S", "L", "R", "P", "U+S", "U+L", "U+R", "U+P", "S+L", "S+R", "S+P", "L+R", "L+P", "R+P", "U+S+L", "U+S+R","U+L+R", "U+R+P", "U+S+P","U+L+P","S+L+R", "S+L+P", "S+R+P", "L+R+P", "U+S+R+P", "U+S+L+R", "U+S+L+P", "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$Combo),]
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = unique(SelectData_Condensed$ComboWn))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$ComboWn),]
if(e %in% c("Prolif_2", "Prolif_4", "Prolif_6")){Axis = c(0,100)}else{Axis = c(0, max(SelectData_Samples$Value)*1.2)}
e = "Apoptosis_6"
if(grepl("Apoptosis", e, fixed = TRUE) == T){
PlotTitle = "Apoptosis"
Control_Ylab = "% Annexin V+"
}
if(grepl("Prolif", e, fixed = TRUE)){
PlotTitle = "Proliferation"
Control_Ylab = "% BrdU +"
}
if(grepl("CellNoNorm", e, fixed = TRUE)){
PlotTitle = "Cell number"
Control_Ylab = "Fold change"
}
if(grepl("Morphology", e, fixed = TRUE)){
PlotTitle = "Morphology"
Control_Ylab = "Morphology score"
}
if(grepl("2", e, fixed = TRUE)){
DayFactor = " - Day 2"
}
if(grepl("4", e, fixed = TRUE)){
DayFactor = " - Day 4"
}
if(grepl("6", e, fixed = TRUE)){
DayFactor = " - Day 6"
}
SelectData = Fig3_4_ComboInhibDatawZeros[, c("Combo", e)]
colnames(SelectData) = c("Combo", "Value")
SelectData = na.omit(SelectData)
SelectData$Value = ifelse(SelectData$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData$Value)
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
d = "S+L+R+P"
! d %in% SelectData_Condensed$Combo
dim(SelectData_Condensed)
dim(SelectData_Condensed)[1] < 32
ExtraData = as.data.frame(ncol = 5, nrow = 32-dim(SelectData_Condensed)[1])
ExtraData = as.data.frame(matrix(ncol = 5, nrow = 32-dim(SelectData_Condensed)[1]))
ExtraData = 0
ExtraData = as.data.frame(matrix(ncol = 5, nrow = 32-dim(SelectData_Condensed)[1]))
View(ExtraData)
ExtraData[is.na(ExtraData)] =  0
colnames(ExtraData) = colnames(SelectData_Condensed)
View(ExtraData)
ExtraData$Combo = subset(c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), ! c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), %in% SelectData_Condensed$Combo)
ExtraData$Combo = subset(c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), ! c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P") %in% SelectData_Condensed$Combo)
SelectData_Condensed = rbind(SelectData_Condensed, ExtraData)
SelectData_Condensed$n = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData_Condensed$n)
#if(DayFactor == " - Day 2"){
SelectData_Condensed$LRColour = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), "Blue", "Neutral")
###
SelectData_Condensed$ComboWn = paste(SelectData_Condensed$Combo, " (n = ", SelectData_Condensed$n, ")", sep="")
SelectData_merge = merge(SelectData_Condensed, SelectData, by = "Combo")
View(SelectData_merge)
SelectData_merge = merge(SelectData_Condensed, SelectData, by = "Combo", all=T)
SelectData_merge = merge(SelectData_Condensed, SelectData, by = "Combo", all=T)
View(SelectData_merge)
######################################
Fig3_4_ComboInhibDatawZeros = Fig3_4_ComboInhibData
ExclLR_All = subset(Fig3_4_ComboInhibDatawZeros,  Fig3_4_ComboInhibDatawZeros$Combo %notin% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
OnlyLR_All = subset(Fig3_4_ComboInhibDatawZeros,  Fig3_4_ComboInhibDatawZeros$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
OnlyLR_All[c("CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")][is.na(OnlyLR_All[c("CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")])] <- 0
Fig3_4_ComboInhibDatawZeros = rbind(OnlyLR_All, ExclLR_All)
#
#
SuppControlEmergFigs = list()
Data_To_Plot = c("Prolif_2", "Prolif_4", "Prolif_6", "Apoptosis_2", "Apoptosis_4", "Apoptosis_6", "CellNoNorm_2", "CellNoNorm_4", "CellNoNorm_6")
for(e in Data_To_Plot){
if(grepl("Apoptosis", e, fixed = TRUE) == T){
PlotTitle = "Apoptosis"
Control_Ylab = "% Annexin V+"
}
if(grepl("Prolif", e, fixed = TRUE)){
PlotTitle = "Proliferation"
Control_Ylab = "% BrdU +"
}
if(grepl("CellNoNorm", e, fixed = TRUE)){
PlotTitle = "Cell number"
Control_Ylab = "Fold change"
}
if(grepl("Morphology", e, fixed = TRUE)){
PlotTitle = "Morphology"
Control_Ylab = "Morphology score"
}
if(grepl("2", e, fixed = TRUE)){
DayFactor = " - Day 2"
}
if(grepl("4", e, fixed = TRUE)){
DayFactor = " - Day 4"
}
if(grepl("6", e, fixed = TRUE)){
DayFactor = " - Day 6"
}
SelectData = Fig3_4_ComboInhibDatawZeros[, c("Combo", e)]
colnames(SelectData) = c("Combo", "Value")
SelectData = na.omit(SelectData)
if(DayFactor %in% c(" - Day 4", " - Day 6")){
SelectData$Value = ifelse(SelectData$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData$Value)
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
if(dim(SelectData_Condensed)[1] < 32){
ExtraData = as.data.frame(matrix(ncol = 5, nrow = 32-dim(SelectData_Condensed)[1]))
ExtraData[is.na(ExtraData)] =  0
colnames(ExtraData) = colnames(SelectData_Condensed)
ExtraData$Combo = subset(c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), ! c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P") %in% SelectData_Condensed$Combo)
SelectData_Condensed = rbind(SelectData_Condensed, ExtraData)
}
SelectData_Condensed$n = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), 0, SelectData_Condensed$n)
}else{
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
}
#if(DayFactor == " - Day 2"){
SelectData_Condensed$LRColour = ifelse(SelectData_Condensed$Combo %in% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"), "Blue", "Neutral")
###
SelectData_Condensed$ComboWn = paste(SelectData_Condensed$Combo, " (n = ", SelectData_Condensed$n, ")", sep="")
SelectData_merge = merge(SelectData_Condensed, SelectData, by = "Combo", all=T)
SelectData_Samples = subset(SelectData, SelectData$Combo %in% SelectData_Condensed$Combo)
PullNames = SelectData_Condensed[, c("Combo", "ComboWn")]
SelectData_Samples = merge(SelectData_Samples, PullNames, by = "Combo")
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = SelectData_Condensed$ComboWn)
ANOVARes = DunnettTest(x=SelectData_Samples$Value, g=SelectData_Samples$Combo, control = "DMSO")
ANOVAResOuts = as.data.frame(ANOVARes[[1]])
row.names(ANOVAResOuts) = gsub("-DMSO", "", row.names(ANOVAResOuts))
ANOVAResOuts$Combo = row.names(ANOVAResOuts)
SelectData_Condensed = merge(SelectData_Condensed, ANOVAResOuts, by = "Combo", all=T)
SelectData_Condensed$Sig = ifelse(SelectData_Condensed$pval < 0.05, "*", NA)
if(DayFactor %in% c(" - Day 4", " - Day 6")){
SelectData_Condensed$Sig =ifelse(SelectData_Condensed$LRColour == "Neutral", SelectData_Condensed$Sig, NA)
}
SelectData_Condensed$Combo = factor(SelectData_Condensed$Combo, levels = c("DMSO", "U", "S", "L", "R", "P", "U+S", "U+L", "U+R", "U+P", "S+L", "S+R", "S+P", "L+R", "L+P", "R+P", "U+S+L", "U+S+R","U+L+R", "U+R+P", "U+S+P","U+L+P","S+L+R", "S+L+P", "S+R+P", "L+R+P", "U+S+R+P", "U+S+L+R", "U+S+L+P", "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$Combo),]
SelectData_Condensed$ComboWn = factor(SelectData_Condensed$ComboWn, levels = unique(SelectData_Condensed$ComboWn))
SelectData_Condensed <- SelectData_Condensed[order(SelectData_Condensed$ComboWn),]
if(e %in% c("Prolif_2", "Prolif_4", "Prolif_6")){Axis = c(0,100)}else{Axis = c(0, max(SelectData_Samples$Value)*1.2)}
SuppControlEmergFigs[[e]] = ggplot(SelectData_Condensed, aes(x=ComboWn, y=Mean,fill = LRColour)) + geom_bar(stat = "identity", color = "#000000") + scale_fill_manual(values = c("Neutral" =  ColourNeutral, "Blue" = ColourTwoWay))  +theme_classic() + geom_hline(yintercept=0) + ylab(Control_Ylab) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2) + theme(legend.position="none", plot.title = element_text(size = 15, face = "bold"), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(paste(PlotTitle, DayFactor, sep = "")) + geom_point(data=SelectData_merge, aes(x = ComboWn, y =Value), color = "#000000", fill = "#000000", size = 0.5)+ geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*6))), position = position_dodge(width = 0.9), size = 1, show.legend = F)+ scale_shape_manual(values=c(8))  + scale_y_continuous(limits = Axis, expand = c(0,0)) + geom_point(data=SelectData_Samples, aes(x = ComboWn, y =Value, fill = "#000000"), size=0.5)
}
SuppEmerg = ggarrange(plotlist = SuppControlEmergFigs, ncol = 1, nrow=3)
pdf(paste(FilePath, "FigureS3S4S5_EmergentPropertiesRaw.pdf", sep=""), width = 12, height = 3*2.8)
print(SuppEmerg)
dev.off()
dim(ExclLR)
range(ExclLR$Mean)
MinAxis = min(ExclLR$Mean)
MaxAxis = max(ExclLR$Mean)
min(ExclLR$Mean)
-5*1.2
SuppControlPCRFigs = list()
Data_To_Plot = c("Rex1", "Oct4", "Dnmt3b", "Fgf5", "Mixl1", "Lefty2", "Otx2", "Morphology")
NRows = length(Data_To_Plot)
for(e in Data_To_Plot){
if(e == "Morphology"){
Ytitle = "Morphology Score"
TitleStyle = "bold"}else{
Ytitle =expression(Log[2]~Fold~Change)
TitleStyle = "bold.italic"}
SelectData = Fig3_4_ComboInhibData[, c("Combo", e)]
colnames(SelectData) = c("Combo", "Value")
SelectData = na.omit(SelectData)
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
SelectData_Condensed_n3 = subset(SelectData_Condensed, SelectData_Condensed$n > 1)
SelectData_Condensed$Combo = factor(SelectData_Condensed$Combo, levels = c("DMSO", "U", "S", "L", "R", "P", "U+S", "U+L", "U+R", "U+P", "S+L", "S+R", "S+P", "L+R", "L+P", "R+P", "U+S+L", "U+S+R", "U+R+P", "U+S+P","U+L+P","S+L+R", "S+L+P", "S+R+P", "L+R+P", "U+S+R+P", "U+S+L+P", "U+S+L+R+P"))
ExclLR = subset(SelectData_Condensed,  SelectData_Condensed$Combo %notin% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
SelectData_ExclLR = subset(SelectData,  SelectData$Combo %notin% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
ExclLR$ComboWn = paste(ExclLR$Combo, " (n = ", ExclLR$n, ")", sep="")
SelectData_ExclLRmerge = merge(ExclLR, SelectData_ExclLR, by = "Combo")
ExclLR <- ExclLR[order(ExclLR$Combo),]
ExclLR$ComboWn = factor(ExclLR$ComboWn, levels = ExclLR$ComboWn)
SelectData_Rm = subset(SelectData, SelectData$Combo %in% ExclLR$Combo )
ANOVARes = DunnettTest(x=SelectData_Rm$Value, g=SelectData_Rm$Combo, control = "DMSO")
ANOVAResOuts = as.data.frame(ANOVARes[[1]])
ANOVAResOuts$Combo = gsub("-DMSO", "", row.names(ANOVAResOuts))
ExclLR = merge(ExclLR, ANOVAResOuts, by = "Combo", all = T)
ExclLR$Sig = ifelse(ExclLR$pval < 0.05, "*", NA)
SuppControlPCRFigs[[e]] = ggplot(ExclLR, aes(x=ComboWn, y=Mean)) + geom_col(fill = ColourNeutral, color = "#000000") + geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*5))), position = position_dodge(width = 0.9), size = 1, show.legend = F) +theme_classic() + geom_hline(yintercept=0) + ylab(Ytitle) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2)+ scale_shape_manual(values=c(8)) + theme(legend.position="none", plot.title = element_text(size = 15, face = TitleStyle), axis.text.x = element_text( angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(e)  + geom_point(data=SelectData_ExclLRmerge, aes(x = ComboWn, y =Value), size=0.5) + scale_y_continuous(expand = c(0,0))
}
pdf(paste(FilePath, "FigureS2_MorphologyRaw.pdf", sep=""), width = 12, height = 2.8)
print(SuppControlPCRFigs[["Morphology"]])
dev.off()
SuppControlPCRFigs[["Morphology"]] = NULL
NRows = length(SuppControlPCRFigs)
SuppPCR = ggarrange(plotlist = SuppControlPCRFigs, ncol = 1, nrow=NRows)
pdf(paste(FilePath, "FigureS9_GeneExpressionRaw.pdf", sep=""), width = 12, height = NRows*2.8)
print(SuppPCR)
dev.off()
ggplot(ExclLR, aes(x=ComboWn, y=Mean)) + geom_col(fill = ColourNeutral, color = "#000000") + geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*5))), position = position_dodge(width = 0.9), size = 1, show.legend = F) +theme_classic() + geom_hline(yintercept=0) + ylab(Ytitle) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2)+ scale_shape_manual(values=c(8)) + theme(legend.position="none", plot.title = element_text(size = 15, face = TitleStyle), axis.text.x = element_text( angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(e)  + geom_point(data=SelectData_ExclLRmerge, aes(x = ComboWn, y =Value), size=0.5) + scale_y_continuous(expand = c(0,0))
SuppControlPCRFigs = list()
Data_To_Plot = c("Rex1", "Oct4", "Dnmt3b", "Fgf5", "Mixl1", "Lefty2", "Otx2", "Morphology")
NRows = length(Data_To_Plot)
for(e in Data_To_Plot){
if(e == "Morphology"){
Ytitle = "Morphology Score"
TitleStyle = "bold"}else{
Ytitle =expression(Log[2]~Fold~Change)
TitleStyle = "bold.italic"}
SelectData = Fig3_4_ComboInhibData[, c("Combo", e)]
colnames(SelectData) = c("Combo", "Value")
SelectData = na.omit(SelectData)
SelectData_Condensed = SelectData %>% group_by(Combo) %>% summarise(n = n(), Mean = mean(Value), stdev = sd(Value), se=sd(Value)/sqrt(n()))
SelectData_Condensed_n3 = subset(SelectData_Condensed, SelectData_Condensed$n > 1)
SelectData_Condensed$Combo = factor(SelectData_Condensed$Combo, levels = c("DMSO", "U", "S", "L", "R", "P", "U+S", "U+L", "U+R", "U+P", "S+L", "S+R", "S+P", "L+R", "L+P", "R+P", "U+S+L", "U+S+R", "U+R+P", "U+S+P","U+L+P","S+L+R", "S+L+P", "S+R+P", "L+R+P", "U+S+R+P", "U+S+L+P", "U+S+L+R+P"))
ExclLR = subset(SelectData_Condensed,  SelectData_Condensed$Combo %notin% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
SelectData_ExclLR = subset(SelectData,  SelectData$Combo %notin% c("L+R", "U+L+R", "S+L+R", "L+R+P", "U+S+L+R",  "U+L+R+P", "S+L+R+P",  "U+S+L+R+P"))
ExclLR$ComboWn = paste(ExclLR$Combo, " (n = ", ExclLR$n, ")", sep="")
SelectData_ExclLRmerge = merge(ExclLR, SelectData_ExclLR, by = "Combo")
ExclLR <- ExclLR[order(ExclLR$Combo),]
ExclLR$ComboWn = factor(ExclLR$ComboWn, levels = ExclLR$ComboWn)
SelectData_Rm = subset(SelectData, SelectData$Combo %in% ExclLR$Combo )
ANOVARes = DunnettTest(x=SelectData_Rm$Value, g=SelectData_Rm$Combo, control = "DMSO")
ANOVAResOuts = as.data.frame(ANOVARes[[1]])
ANOVAResOuts$Combo = gsub("-DMSO", "", row.names(ANOVAResOuts))
ExclLR = merge(ExclLR, ANOVAResOuts, by = "Combo", all = T)
ExclLR$Sig = ifelse(ExclLR$pval < 0.05, "*", NA)
SuppControlPCRFigs[[e]] = ggplot(ExclLR, aes(x=ComboWn, y=Mean)) + geom_col(fill = ColourNeutral, color = "#000000") + geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*5))), position = position_dodge(width = 0.9), size = 1, show.legend = F) +theme_classic() + geom_hline(yintercept=0) + ylab(Ytitle) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2)+ scale_shape_manual(values=c(8)) + theme(legend.position="none", plot.title = element_text(size = 15, face = TitleStyle), axis.text.x = element_text( angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(e)  + geom_point(data=SelectData_ExclLRmerge, aes(x = ComboWn, y =Value), size=0.5) + scale_y_continuous(expand = c(0,0))
}
pdf(paste(FilePath, "FigureS2_MorphologyRaw.pdf", sep=""), width = 12, height = 2.8)
print(SuppControlPCRFigs[["Morphology"]])
dev.off()
SuppControlPCRFigs[["Morphology"]] = NULL
NRows = length(SuppControlPCRFigs)
SuppPCR = ggarrange(plotlist = SuppControlPCRFigs, ncol = 1, nrow=NRows)
pdf(paste(FilePath, "FigureS9_GeneExpressionRaw.pdf", sep=""), width = 12, height = NRows*2.8)
print(SuppPCR)
dev.off()
ggplot(ExclLR, aes(x=ComboWn, y=Mean)) + geom_col(fill = ColourNeutral, color = "#000000") + geom_point(aes(color = ColourTwoWay, shape = Sig, y = Mean + sign(Mean) * (se + (se*5))), position = position_dodge(width = 0.9), size = 1, show.legend = F) +theme_classic() + geom_hline(yintercept=0) + ylab(Ytitle) + xlab("") + geom_errorbar(aes(ymin = Mean-se, ymax = Mean+se), position = position_dodge(width = 0.9), width = 0.2)+ scale_shape_manual(values=c(8)) + theme(legend.position="none", plot.title = element_text(size = 15, face = TitleStyle), axis.text.x = element_text( angle = 90, vjust = 0.5, hjust=1, face = "bold")) + ggtitle(e)  + geom_point(data=SelectData_ExclLRmerge, aes(x = ComboWn, y =Value), size=0.5) + scale_y_continuous(expand = c(0,0))
SuppControlPCRFigs[["Otx2"]]
library(tidyverse)
library(igraph)
library(monocle3)
library(Seurat)
HypoMapHUMAN = readRDS("~/Hypothalamus_HumanMouseInt.rds")
HypoMapHUMAN@meta.data$Species = ifelse(HypoMapHUMAN@meta.data$Dataset %in% c("Herb", "Siletti", "Zhou"), "Human", "Mouse")
HypoMapHUMAN@meta.data$Human = ifelse(HypoMapHUMAN@meta.data$Dataset %in% c("Herb", "Zhou"), "HumanDevelopment", "None")
HypoMapHUMAN@meta.data$Human = ifelse(HypoMapHUMAN@meta.data$Dataset %in% c("Siletti"), "HumanAdult", HypoMapHUMAN@meta.data$Human)
HypoMapHUMAN@meta.data$SpeciesStage = ifelse(HypoMapHUMAN@meta.data$Human %in% c("None") & HypoMapHUMAN@meta.data$Dataset %in% c("RomanovDev", "KimDev"), "MouseDevelopment", HypoMapHUMAN@meta.data$Human)
HypoMapHUMAN@meta.data$SpeciesStage = ifelse(HypoMapHUMAN@meta.data$SpeciesStage %in% c("None"), "MouseAdult", HypoMapHUMAN@meta.data$SpeciesStage)
Idents(HypoMapHUMAN) = "SpeciesStage"
MouseAdultSeu = subset(HypoMapHUMAN, idents = "MouseAdult")
MN_TopHits = readRDS("~/Downloads/Figure 3/MN_July_2023_top_hits_NV_humanK116_mouseC185.rds")
View(MN_TopHits)
DatasetClust = MouseAdultSeu@meta.data %>% group_by(C185_named) %>% summarise("Count" = n(DatasetClean))
DatasetClust = MouseAdultSeu@meta.data %>% group_by(C185_named) %>% dplyr::summarise("Count" = n(DatasetClean))
DatasetClust = MouseAdultSeu@meta.data %>% group_by(C185_named, DatasetClean) %>% dplyr::summarise("Count" = n())
View(DatasetClust)
DatasetOrig = as.data.frame(table(MouseAdultSeu@meta.data$DatasetClean))
ClustOrig = as.data.frame(table(MouseAdultSeu@meta.data$C185_named))
View(ClustOrig)
DatasetClustMerge = merge(DatasetClust, DatasetOrig, by = "Var1")
View(DatasetClust)
DatasetClustMerge = merge(DatasetClust, DatasetOrig, by.x = "C185_named", by.y = "Var1")
Var1
DatasetClustMerge = merge(DatasetClust, DatasetOrig, by.x = "C185_named", by.y = "Var1")
colnames(DatasetClust)
DatasetClustMerge = merge(DatasetClust, DatasetOrig, by.x = "DatasetClean", by.y = "Var1")
DatasetClustMerge = merge(DatasetClustMerge, ClustOrig, by.x = "C185_named", by.y = "Var1")
View(DatasetClustMerge)
DatasetClustMerge$PctDataset = DatasetClustMerge$Count/DatasetClustMerge$Freq.x
x = sort(unique(MouseAdultSeu@meta.data))[1]
x = sort(unique(MouseAdultSeu@meta.data$C185_named))[1]
PullCluster = subset(MouseAdultSeu@meta.data, MouseAdultSeu@meta.data$$C185_named == x)
PullCluster = subset(MouseAdultSeu@meta.data, MouseAdultSeu@meta.data$C185_named == x)
View(PullCluster)
PullCluster = as.data.frame(table(subset(MouseAdultSeu@meta.data, MouseAdultSeu@meta.data$C185_named == x)$C185_named)
}
PullCluster = subset(MouseAdultSeu@meta.data, MouseAdultSeu@meta.data$C185_named == x)
PullClusterTab = as.data.frame(PullCluster$C185_named)
View(PullClusterTab)
PullClusterTab = as.data.frame(table(PullCluster$C185_named))
View(PullClusterTab)
PullClusterTab = as.data.frame(table(PullCluster$DatasetClean))
View(PullClusterTab)
PullClusterTab = merge(PullClusterTab, DatasetOrig, by = "Var1")
PullClusterTab$Pct = PullClusterTab$Freq.x/PullClusterTab$Freq.y
PullClusterTab$PctNorm = PullClusterTab$Pct/sum(PullClusterTab$Pct)*100
paste(PullClusterTab$Var1, " [", round(PullClusterTab$Pct/sum(PullClusterTab$Pct)*100, digits = 2), "%]", sep=""), collapse = "; ")
paste(paste(PullClusterTab$Var1, " [", round(PullClusterTab$Pct/sum(PullClusterTab$Pct)*100, digits = 2), "%]", sep=""), collapse = "; ")
as.data.frame(c(x, paste(paste(PullClusterTab$Var1, " [", round(PullClusterTab$Pct/sum(PullClusterTab$Pct)*100, digits = 2), "%]", sep=""), collapse = "; ")))
DATA = as.data.frame(t(c(x, paste(paste(PullClusterTab$Var1, " [", round(PullClusterTab$Pct/sum(PullClusterTab$Pct)*100, digits = 2), "%]", sep=""), collapse = "; "))))
View(DATA)
HypoMapDatasetCompile = as.data.frame(matrix(ncol=2,nrow=0))
View(DATA)
HypoMapDatasetCompile = as.data.frame(matrix(ncol=2,nrow=0))
for(x in sort(unique(MouseAdultSeu@meta.data$C185_named))){
PullCluster = subset(MouseAdultSeu@meta.data, MouseAdultSeu@meta.data$C185_named == x)
PullClusterTab = as.data.frame(table(PullCluster$DatasetClean))
PullClusterTab = merge(PullClusterTab, DatasetOrig, by = "Var1")
PullClusterTab$Pct = PullClusterTab$Freq.x/PullClusterTab$Freq.y
PullClusterTab$PctNorm = PullClusterTab$Pct/sum(PullClusterTab$Pct)*100
PullClusterTab = PullClusterTab[order(-PullClusterTab$PctNorm), ]
DATA = as.data.frame(t(c(x, paste(paste(PullClusterTab$Var1, " [", round(PullClusterTab$Pct/sum(PullClusterTab$Pct)*100, digits = 2), "%]", sep=""), collapse = "; "))))
HypoMapDatasetCompile = rbind(HypoMapDatasetCompile, DATA)
}
View(HypoMapDatasetCompile)
View(MN_TopHits)
