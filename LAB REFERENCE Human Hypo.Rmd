---
title: "Human Hypo - Lab Reference"
output: html_notebook
---

#Packages
```{r}
library(Seurat)
library(tidyverse)
```


# Data for 'Single-cell genomics reveals region-specific developmental trajectories underlying neuronal diversity in the human hypothalamus'. Science Advances. 2023

#### Human Hypothalamus: all fetal cells - from paper figure 1
Primary Analysis: https://github.com/Hannahglover/Human-Hypothalamus/blob/main/SciAdv%20Submission/SciAdv_FIG1.Rmd

Key Metadata:
- CellAnnotations: Cluster annotations for cell assignments
- Timepoint: Sample timepoint
- Study: Herb or Zhou  
- Timepoint_Study: Herb or Zhou with timepoint

```{r}
x = readRDS("/Users/hannahglover/Library/CloudStorage/Box-Box/HG2553 Main Folder/LAB DATASETS/HUMAN HYPO/KaZhouAll.rds")
```

#### Human Hypothalamus: Neurons from paper figure 2
Primary Analysis: https://github.com/Hannahglover/Human-Hypothalamus/blob/main/SciAdv%20Submission/SciAdv_FIG2.Rmd

Key Metadata:
- SampleBroad: Fetal samples by time point, adult samples by dissection with timepoints pooled
- SampleAdult: Fetal samples by time point, adult samples pooled together
- SampleDissect: Fetal samples by time point, adult samples by dissection and timepoint
- FetalAdult: Split as fetal v adult
- SampleTime: All samples by timepoint including adult split by age
- Stage: Adult Trimester1 Trimester2
- H6, H16, H27, H38, H53, H108 , H148, H170, H192, H226, H264, H290, H320, H344, H369: mrTree clusters (numeric only)
- H108_Class: Neurotransmitters at H108 level
- H108_Nuclei: Adult hypothalamic nuclei annotations at H108 level
- H108_MarkerGenes: Marker gene combinations used for annotating adult cells to nuclei at H108 level
- H369_Class: Neurotransmitters at H369 level
- H369_MarkerGenes: Marker gene combinations used for annotating adult cells to nuclei at H369 level
- H369_Nuclei: Adult hypothalamic nuclei annotations at H369 level
- PseudotimeVertex: Pseudotime vertex assignments for the main lineage presented in Fig 2
- AdultFetal_ExtrapolatedNuclei: Hypothalamic nuclei annotations including annotations for fetal cells based on the H108 level clusters
- AdultFetal_ExtrapolatedClass : Hypothalamic neurotransmitter annotations including annotations for fetal cells based on the H108 level clusters


```{r}
EdKaZhouHypoNeurons = readRDS("/Users/hannahglover/Library/CloudStorage/Box-Box/HG2553 Main Folder/LAB DATASETS/HUMAN HYPO/EdKaZhouHypoNeurons.rds")
Idents(EdKaZhouHypoNeurons) = "AdultFetal_ExtrapolatedNuclei"
DefaultAssay(EdKaZhouHypoNeurons) = "RNA"
```


#### Human and mouse hypothalamus from paper figure 3
Integration: https://github.com/Hannahglover/Human-Hypothalamus/blob/main/IntegrateHumanNeuronswHypoMapDev.R
Primary Analysis: https://github.com/Hannahglover/Human-Hypothalamus/blob/main/SciAdv%20Submission/SciAdv_FIG3.Rmd


Key Metadata:
- DatasetClean: Data source including study, species and nuclei (where available)
- Species: Mouse or Human
- SpeciesStage: MouseDevelopment, HumanDevelopment, HumanAdult, MouseAdult
- C2_named, C7_named, C25_named, C66_named, C185_named, C286_named, C465_named, Region_predicted, Region_summarized: HypoMap Metadata for mouse
- H6, H16, H27, H38, H53, H108 , H148, H170, H192, H226, H264, H290, H320, H344, H369: adult mrTree clusters (numeric only) from figure 2
- Region_summarized_Clean: Adult Human nuclei annotation at H108
```{r}
Hypothalamus_HumanMouseInt = readRDS("/Users/hannahglover/Library/CloudStorage/Box-Box/HG2553 Main Folder/LAB DATASETS/HUMAN HYPO/Hypothalamus_HumanMouseInt.rds")
```
                     

####################################################################################################'

# Additional Data - Also contains Neonate data from Huang et al.

#### Human Hypothalamus - All cells: Fetal/Neonate [Equivalent to Figure 1 but with new clustering]
Primary Analysis: https://github.com/Hannahglover/Human-Hypothalamus/blob/main/NeoHypo_Integration.Rmd


Key Metadata:
- Study: Huang (Neonate), Kriegstein or Zhou (Both Fetal)
- Timepoint: Specific timepoint
- Clusters_Round4: This is the cluster assignments
- SampleStudy: Study and timepoint
```{r}
AllCells = readRDS("/Users/hannahglover/Library/CloudStorage/Box-Box/HG2553 Main Folder/LAB DATASETS/HUMAN HYPO/NeoFetalAll.combined.rds")
AllCells$Study = ifelse(AllCells$Timepoint %in% c("0D", "42D", "54D", "79D", "225D"), "Huang", AllCells$Study)
AllCells$SampleStudy = paste(AllCells@meta.data$Study, AllCells@meta.data$Timepoint, sep="_")
```


#### Human Neurons: Fetal/Neonate/Adult [Equivalent to Figure 2 but without clustering]
Most useful for feature plots as the neonate data has not been clustered

Primary Analysis: https://github.com/Hannahglover/Human-Hypothalamus/blob/main/Integrate_All_HypoData_IncNeo.R
Pseudotime Trajectories: https://github.com/Hannahglover/Human-Hypothalamus/blob/main/NeoTrajectories_SEP23.Rmd


Key Metadata: 
- Study: Huang (Neonate), Kriegstein (Herb primary daya), Zhou (Both Fetal), Siletti (Herb primary adult)
- Stage: Trimester 1, trimester 2, neonate, adult
- Timepoint: Specific timepoint
- StudyTime: Study and timepoint

```{r}
HumNeurons = readRDS("/Users/hannahglover/Library/CloudStorage/Box-Box/HG2553 Main Folder/LAB DATASETS/HUMAN HYPO/HypoNeoNeur_29AUG23.rds")
HumNeurons$Timepoint = ifelse(HumNeurons$Age %in% c(29, 42, 50), paste0(HumNeurons$Age, "Y"), HumNeurons$Timepoint)
HumNeurons@meta.data$Age
HumNeurons$Stage = ifelse(HumNeurons$Timepoint %in% c("GW6", "GW7", "GW8", "GW10", "GW12"), "Trimester 1", "Trimester 2")
HumNeurons$Stage = ifelse(HumNeurons$Timepoint %in% c("0D", "42D", "54D", "225D"), "Neonate", HumNeurons$Stage)
HumNeurons$Stage = ifelse(HumNeurons$Timepoint %in% c("29Y", "42Y", "50Y"), "Adult", HumNeurons$Stage)
HumNeurons$Study = ifelse(HumNeurons$Timepoint %in% c("29Y", "42Y", "50Y"), "Siletti", HumNeurons$Study)
HumNeurons$StudyTime = ifelse(HumNeurons$Timepoint %in% c("29Y", "42Y", "50Y"), paste("Siletti", HumNeurons$Timepoint, sep="_"), HumNeurons$StudyTime)
```
         
